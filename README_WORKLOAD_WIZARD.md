# Karmada 工作负载图形化向导功能

## 功能概述

为 Karmada Dashboard 实现了完整的图形化向导功能，支持通过用户友好的界面创建各种类型的工作负载，而无需手写 YAML 文件。向导会根据用户输入自动生成标准的 Kubernetes YAML 配置，然后通过现有的后端 API 提交创建。

## 支持的工作负载类型

### 1. Deployment
- **特性**: 无状态应用部署，支持滚动更新和弹性扩缩容
- **专有配置**:
  - 副本数设置 (1-100)
  - 更新策略 (滚动更新/重新创建)
  - 滚动更新参数 (最大不可用、最大激增)

### 2. StatefulSet
- **特性**: 有状态应用部署，提供稳定的网络标识和持久化存储
- **专有配置**:
  - 副本数设置
  - 服务名称配置
  - Pod 管理策略 (顺序就绪/并行)

### 3. DaemonSet
- **特性**: 守护进程集，在每个节点上运行一个 Pod 副本
- **专有配置**:
  - 自动在所有节点部署
  - 节点选择器支持

### 4. Job
- **特性**: 一次性任务，运行完成后退出
- **专有配置**:
  - 并发数和完成数
  - 重试次数限制
  - 重启策略 (Never/OnFailure)
  - 超时时间和自动清理配置

### 5. CronJob
- **特性**: 定时任务，按照 Cron 表达式定期执行
- **专有配置**:
  - Cron 调度表达式 (支持常用模板)
  - 并发策略 (允许并发/禁止并发/替换旧任务)
  - 历史记录限制
  - 启动截止时间

## 向导界面设计

### 4步式向导流程

1. **基本配置** - 设置工作负载基本信息
   - 工作负载名称 (含验证规则)
   - 命名空间
   - 特定工作负载类型的配置选项

2. **容器配置** - 配置容器镜像和运行参数
   - 容器基本信息 (名称、镜像、拉取策略)
   - 端口配置 (支持多端口)
   - 环境变量设置
   - 资源限制 (CPU/内存的请求和限制)
   - 健康检查 (存活探针和就绪探针)

3. **高级配置** - 标签、注解和调度配置
   - 自定义标签和注解
   - 节点选择器配置

4. **配置预览** - 检查并确认配置
   - 生成的 YAML 预览
   - 配置摘要信息
   - 一键复制 YAML

### 界面特色

- **响应式设计**: 支持不同屏幕尺寸
- **分类折叠**: 容器配置使用折叠面板组织
- **实时验证**: 表单字段实时验证
- **智能提示**: 工具提示和帮助信息
- **预设模板**: 常用 Cron 表达式快速选择
- **徽章计数**: 显示配置项数量
- **美观图标**: 不同功能区域使用对应图标

## 技术实现

### 核心组件
- `WorkloadWizardModal`: 主向导组件
- 支持的工作负载类型枚举: `WorkloadKind`
- YAML 生成器: 根据配置动态生成标准 Kubernetes YAML

### 数据流
1. 用户通过向导界面填写配置
2. 实时更新内部状态 `workloadConfig`
3. 最后一步生成完整的 YAML 配置
4. 调用现有的 `CreateResource` API 提交
5. 成功后刷新工作负载列表

### 与现有系统集成
- **无需修改后端**: 完全使用现有的 unstructured API
- **保持一致性**: 生成的 YAML 符合 Kubernetes 标准
- **统一入口**: 通过下拉菜单选择创建方式 (图形化向导/YAML编辑器)

## 功能亮点

### 1. 健康检查配置
- 支持 HTTP、TCP、Exec 三种探针类型
- 可分别配置存活探针和就绪探针
- 详细的参数设置 (延迟、间隔、超时等)

### 2. 资源管理
- CPU 和内存的请求/限制配置
- 单位提示 (millicores, Mi/Gi)
- 合理的默认值

### 3. 多容器支持
- 支持添加/删除多个容器
- 每个容器独立配置
- 容器编号和名称显示

### 4. 智能默认值
- 根据工作负载类型设置合适的默认配置
- 常用镜像拉取策略预设
- 标准的资源限制建议

### 5. 用户体验优化
- 步骤式导航，清晰的进度指示
- 表单验证和错误提示
- 一键重置和取消功能
- YAML 预览和复制功能

## 使用指南

1. 在工作负载管理页面点击"创建工作负载"按钮
2. 选择"图形化向导"选项
3. 根据当前选择的工作负载类型逐步配置
4. 在预览页面确认配置无误后点击"创建"

## 扩展性

该向导采用模块化设计，便于未来扩展：
- 新增工作负载类型只需扩展 `renderWorkloadSpecificConfig` 方法
- 新增容器配置选项可扩展容器配置面板
- YAML 生成器支持灵活的配置映射

## 技术栈

- **React**: 组件化开发
- **Ant Design**: UI 组件库
- **TypeScript**: 类型安全
- **YAML**: 配置序列化
- **现有 API**: 无缝集成后端服务 