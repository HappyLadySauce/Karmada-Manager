# ğŸš€ Karmada é›†ç¾¤è°ƒåº¦ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

Karmadaé›†ç¾¤è°ƒåº¦ç³»ç»Ÿæä¾›äº†ä¸€å¥—å®Œæ•´çš„å¤šé›†ç¾¤å·¥ä½œè´Ÿè½½è°ƒåº¦ç›‘æ§å’Œç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š

- **è°ƒåº¦æ¦‚è§ˆ**: æŸ¥çœ‹æ•´ä½“è°ƒåº¦ç»Ÿè®¡ä¿¡æ¯
- **æ‹“æ‰‘è§†å›¾**: å·¥ä½œè´Ÿè½½åœ¨å¤šé›†ç¾¤ä¸­çš„åˆ†å¸ƒå¯è§†åŒ–
- **è¯¦ç»†ä¿¡æ¯**: æ·±å…¥åˆ°èŠ‚ç‚¹çº§åˆ«çš„Podåˆ†å¸ƒè¯¦æƒ…
- **å®æ—¶ç›‘æ§**: é›†ç¾¤çŠ¶æ€ã€å‰¯æœ¬å¥åº·åº¦ç­‰å®æ—¶æ•°æ®

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚   å‰ç«¯ç•Œé¢      â”‚â—„â”€â”€â–ºâ”‚   åç«¯API       â”‚â—„â”€â”€â–ºâ”‚   Karmada      â”‚
â”‚   (React)       â”‚    â”‚   (Go)          â”‚    â”‚   æ§åˆ¶å¹³é¢      â”‚
â”‚   Port: 5174    â”‚    â”‚   Port: 8000    â”‚    â”‚                 â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. è°ƒåº¦æ¦‚è§ˆé¡µé¢
- **ç»Ÿè®¡å¡ç‰‡**: æ€»å·¥ä½œè´Ÿè½½ã€å·²è°ƒåº¦ã€å¾…è°ƒåº¦ã€å¤±è´¥æ•°é‡
- **é›†ç¾¤åˆ†å¸ƒ**: æ˜¾ç¤ºå„é›†ç¾¤çš„å·¥ä½œè´Ÿè½½åˆ†å¸ƒå’Œå¥åº·çŠ¶æ€
- **å‘½åç©ºé—´ç»Ÿè®¡**: æŒ‰å‘½åç©ºé—´æŸ¥çœ‹è°ƒåº¦æƒ…å†µ

### 2. æ‹“æ‰‘è§†å›¾é¡µé¢
- **å·¥ä½œè´Ÿè½½åˆ—è¡¨**: å¯äº¤äº’çš„å·¥ä½œè´Ÿè½½è¡¨æ ¼
- **è°ƒåº¦çŠ¶æ€**: å®æ—¶æ˜¾ç¤ºè°ƒåº¦é˜¶æ®µå’Œå‰¯æœ¬çŠ¶æ€
- **é›†ç¾¤åˆ†å¸ƒ**: å·¥ä½œè´Ÿè½½åœ¨å„é›†ç¾¤çš„åˆ†å¸ƒæƒ…å†µ

### 3. è¯¦ç»†ä¿¡æ¯é¡µé¢ ğŸ¯
- **å·¥ä½œè´Ÿè½½è¯¦æƒ…**: åŸºæœ¬ä¿¡æ¯ã€å‰¯æœ¬çŠ¶æ€ã€è°ƒåº¦ç­–ç•¥
- **é›†ç¾¤åˆ†å¸ƒè¯¦æƒ…**: å¯æŠ˜å å±•å¼€çš„é›†ç¾¤çº§ä¿¡æ¯
- **èŠ‚ç‚¹çº§åˆ†å¸ƒ**: è¯¦ç»†çš„èŠ‚ç‚¹èµ„æºå’ŒPodä¿¡æ¯
- **Podçº§è¯¦æƒ…**: å•ä¸ªPodçš„çŠ¶æ€ã€IPã€é‡å¯æ¬¡æ•°ç­‰

## ğŸ“± ç•Œé¢é¢„è§ˆ

### æ¦‚è§ˆé¡µé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ€»å·¥ä½œè´Ÿè½½ â”‚ å·²è°ƒåº¦   â”‚ å¾…è°ƒåº¦   â”‚ å¤±è´¥    â”‚
â”‚   2     â”‚   2     â”‚   0     â”‚   0     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é›†ç¾¤åˆ†å¸ƒ       â”‚  â”‚  å‘½åç©ºé—´ç»Ÿè®¡     â”‚
â”‚                â”‚  â”‚                â”‚
â”‚ â— master       â”‚  â”‚ ğŸ“¦ test         â”‚
â”‚   2ä¸ªå·¥ä½œè´Ÿè½½    â”‚  â”‚ æ€»è®¡:2 è°ƒåº¦:2   â”‚
â”‚   å‰¯æœ¬: 8/8     â”‚  â”‚                â”‚
â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% â”‚  â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¯¦ç»†ä¿¡æ¯é¡µé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš€ å·¥ä½œè´Ÿè½½è¯¦æƒ…: nginx-1                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åç§°: nginx-1        â”‚ æ€»å‰¯æœ¬æ•°: 3                       â”‚
â”‚ å‘½åç©ºé—´: test       â”‚ å°±ç»ªå‰¯æœ¬æ•°: 3                     â”‚
â”‚ ç±»å‹: Deployment     â”‚ è°ƒåº¦çŠ¶æ€: âœ… Scheduled            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—ï¸ é›†ç¾¤: master  å‰¯æœ¬: 3/3  âœ… Ready                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“± èŠ‚ç‚¹åˆ†å¸ƒ (5ä¸ªèŠ‚ç‚¹)                                     â”‚
â”‚                                                         â”‚
â”‚ ğŸ–¥ï¸ m-rke2-master03.example.com (10.10.10.13) [master]   â”‚
â”‚   âœ… Pod: nginx-1-658b854ff4-w9xrs (Running) - 10.42.2.12â”‚
â”‚                                                         â”‚
â”‚ ğŸ–¥ï¸ m-rke2-node01.example.com (10.10.10.14) [worker]     â”‚
â”‚   âœ… Pod: nginx-1-658b854ff4-nh4pd (Running) - 10.42.4.17â”‚
â”‚                                                         â”‚
â”‚ ğŸ–¥ï¸ m-rke2-node02.example.com (10.10.10.15) [worker]     â”‚
â”‚   âœ… Pod: nginx-1-658b854ff4-42pgz (Running) - 10.42.3.14â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- **Karmada**: v1.31.3+
- **Go**: 1.19+
- **Node.js**: 16+
- **æ“ä½œç³»ç»Ÿ**: Linux

### 1. å¯åŠ¨åç«¯APIæœåŠ¡

```bash
# ç¼–è¯‘é¡¹ç›®
cd /root/Karmada-Manager
KUBECONFIG=/etc/karmada/karmada-apiserver.config make

# å¯åŠ¨APIæœåŠ¡
KUBECONFIG=/etc/karmada/karmada-apiserver.config \
_output/bin/linux/amd64/karmada-dashboard-api \
--karmada-kubeconfig=/etc/karmada/karmada-apiserver.config \
--karmada-context=karmada-apiserver \
--kubeconfig=/root/.kube/config \
--context=default \
--insecure-port=8000 &
```

### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
# å®‰è£…ä¾èµ–
cd ui/apps/dashboard
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 3. è®¿é—®ç³»ç»Ÿ

- **å‰ç«¯ç•Œé¢**: http://localhost:5174
- **åç«¯API**: http://localhost:8000/api/v1
- **APIæ–‡æ¡£**: [cluster-scheduling-api.md](./cluster-scheduling-api.md)

## ğŸ§ª åŠŸèƒ½æµ‹è¯•

### ä½¿ç”¨æµ‹è¯•è„šæœ¬

```bash
# è¿è¡Œå®Œæ•´APIæµ‹è¯•
./agent/backend/API/test-scheduling-api.sh
```

### æ‰‹åŠ¨æµ‹è¯•å…³é”®æ¥å£

```bash
# 1. æµ‹è¯•è°ƒåº¦æ¦‚è§ˆ
curl "http://127.0.0.1:8000/api/v1/scheduling/overview"

# 2. æµ‹è¯•å·¥ä½œè´Ÿè½½åˆ—è¡¨
curl "http://127.0.0.1:8000/api/v1/scheduling/namespace/test/workloads"

# 3. æµ‹è¯•ç²¾ç¡®è°ƒåº¦ä¿¡æ¯ (æ ¸å¿ƒåŠŸèƒ½)
curl "http://127.0.0.1:8000/api/v1/workloads/test/nginx-1/precise-scheduling?kind=Deployment"
```

### é¢„æœŸæµ‹è¯•ç»“æœ

âœ… **æˆåŠŸæŒ‡æ ‡**:
- æ‰€æœ‰APIè¿”å›200çŠ¶æ€ç 
- ç²¾ç¡®è°ƒåº¦APIæ˜¾ç¤ºèŠ‚ç‚¹çº§Podåˆ†å¸ƒ
- å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½å’Œäº¤äº’
- å·¥ä½œè´Ÿè½½è¯¦æƒ…é¡µé¢æ˜¾ç¤ºå®Œæ•´ä¿¡æ¯

## ğŸ“Š æ•°æ®è¯´æ˜

### å½“å‰æµ‹è¯•ç¯å¢ƒæ•°æ®

**é›†ç¾¤é…ç½®**:
- **ä¸»é›†ç¾¤**: master (5ä¸ªèŠ‚ç‚¹: 3ä¸ªmaster + 2ä¸ªworker)
- **å·¥ä½œè´Ÿè½½**: 2ä¸ªDeployment (nginx-1, nginx-2)
- **æ€»å‰¯æœ¬æ•°**: 8ä¸ª (nginx-1: 3ä¸ª, nginx-2: 5ä¸ª)

**èŠ‚ç‚¹è¯¦æƒ…**:
- **m-rke2-master01.example.com** (10.10.10.11) - MasterèŠ‚ç‚¹
- **m-rke2-master02.example.com** (10.10.10.12) - MasterèŠ‚ç‚¹  
- **m-rke2-master03.example.com** (10.10.10.13) - MasterèŠ‚ç‚¹
- **m-rke2-node01.example.com** (10.10.10.14) - WorkerèŠ‚ç‚¹
- **m-rke2-node02.example.com** (10.10.10.15) - WorkerèŠ‚ç‚¹

**Podåˆ†å¸ƒç¤ºä¾‹**:
```
nginx-1 (3ä¸ªå‰¯æœ¬):
â”œâ”€â”€ master03: nginx-1-658b854ff4-w9xrs (10.42.2.12)
â”œâ”€â”€ node01: nginx-1-658b854ff4-nh4pd (10.42.4.17)
â””â”€â”€ node02: nginx-1-658b854ff4-42pgz (10.42.3.14)

nginx-2 (5ä¸ªå‰¯æœ¬):
â”œâ”€â”€ master01: nginx-2-7789f4d6b-wlnlb (10.42.0.34)
â”œâ”€â”€ master02: nginx-2-7789f4d6b-jmjpc (10.42.1.15)
â”œâ”€â”€ master03: nginx-2-7789f4d6b-lh9wm (10.42.2.13)
â”œâ”€â”€ node01: nginx-2-7789f4d6b-mzf7c (10.42.4.18)
â””â”€â”€ node02: nginx-2-7789f4d6b-w84vr (10.42.3.15)
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. APIè¿”å›ç©ºæ•°æ®**
```bash
# æ£€æŸ¥Karmadaè¿æ¥
kubectl --kubeconfig=/etc/karmada/karmada-apiserver.config get resourcebindings -n test

# ç¡®è®¤å·¥ä½œè´Ÿè½½å­˜åœ¨
kubectl --kubeconfig=/etc/karmada/karmada-apiserver.config get deployments -n test
```

**2. å‰ç«¯æ— æ³•è®¿é—®API**
```bash
# æ£€æŸ¥APIæœåŠ¡çŠ¶æ€
ps aux | grep karmada-dashboard-api

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulnp | grep :8000
```

**3. Podè¿‡æ»¤ä¸æ­£ç¡®**
- ç¡®è®¤Podæ ‡ç­¾åŒ…å« `app: workload-name`
- æ£€æŸ¥ResourceBindingä¸Deploymentçš„åŒ¹é…é€»è¾‘

### æ—¥å¿—æŸ¥çœ‹

```bash
# APIæœåŠ¡æ—¥å¿—
tail -f /tmp/api.log

# å‰ç«¯æœåŠ¡æ—¥å¿—
tail -f /tmp/frontend.log
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### åç«¯ä¼˜åŒ–
- ä½¿ç”¨ç¼“å­˜å‡å°‘Kubernetes APIè°ƒç”¨
- å®ç°å¢é‡æ›´æ–°æœºåˆ¶
- æ·»åŠ èµ„æºè®¿é—®æƒé™æ§åˆ¶

### å‰ç«¯ä¼˜åŒ–
- å®ç°æ•°æ®åˆ†é¡µå’Œè™šæ‹Ÿæ»šåŠ¨
- æ·»åŠ å®æ—¶æ•°æ®åˆ·æ–°
- ä¼˜åŒ–å¤§é‡èŠ‚ç‚¹çš„æ¸²æŸ“æ€§èƒ½

## ğŸ”® æœªæ¥è®¡åˆ’

### çŸ­æœŸç›®æ ‡
- [ ] æ”¯æŒæ›´å¤šå·¥ä½œè´Ÿè½½ç±»å‹ (StatefulSet, DaemonSetç­‰)
- [ ] æ·»åŠ å¤šé›†ç¾¤åˆ‡æ¢åŠŸèƒ½
- [ ] å®ç°è°ƒåº¦ç­–ç•¥ç¼–è¾‘åŠŸèƒ½

### é•¿æœŸç›®æ ‡  
- [ ] é›†æˆå‘Šè­¦å’Œé€šçŸ¥ç³»ç»Ÿ
- [ ] æ”¯æŒè‡ªå®šä¹‰è°ƒåº¦ç­–ç•¥
- [ ] æä¾›è°ƒåº¦æ€§èƒ½åˆ†æå’Œä¼˜åŒ–å»ºè®®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. **APIæ–‡æ¡£**: [cluster-scheduling-api.md](./cluster-scheduling-api.md)
2. **æµ‹è¯•è„šæœ¬**: [test-scheduling-api.sh](./test-scheduling-api.sh)
3. **ç³»ç»Ÿæ—¥å¿—**: /tmp/api.log å’Œ /tmp/frontend.log

---

**ğŸ‰ æ­å–œï¼ä½ å·²ç»æˆåŠŸæ­å»ºäº†å®Œæ•´çš„Karmadaé›†ç¾¤è°ƒåº¦ç›‘æ§ç³»ç»Ÿï¼** 